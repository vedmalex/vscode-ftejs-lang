<!-- Generated by SpecStory -->

# Обновление файла agents.md из USAGE.md (2025-08-08 18:39Z)

_**User**_

давай обновим файл @agents.md информацией из @USAGE.md 

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Planning edits for documentation**

I'm planning a set of edits to agents.md to incorporate information from USAGE.md for better synchronization. Agents.md serves as a guide for AI agents, covering core concepts and directives, while USAGE.md details runtime functions, directives, and common patterns. The current agents.md references USAGE.md for detailed runtime reference, so the user wants to update agents.md accordingly. I need to decide what to add and consider including a section summarizing runtime functions and directives in the revision.
**Updating documentation sections**

I'm planning to add various sections to agents.md. This will include a summary of runtime helpers like partial, content, and slots with examples, plus a summary for chunks and the options object with specific fields. I want to cover directives and common patterns using slots as well. The user likely expects some content in Russian, but the rules indicate that code and comments should remain in English. So, I’ll ensure that while the documentation remains primarily in English, I’ll keep the user’s preferences in mind for translations.
**Implementing project edits**

The guidelines specify that code and comments must be in English, but the documentation language is left open. Since many repository docs are English, I’ll keep agents.md that way too and won’t change existing comments. I need to implement edits using apply_patch, but since it’s been more than five messages since I accessed the file, I should use functions.read_file first to ensure I have the latest version. This will keep everything in sync while also preparing to add sections under the reference to USAGE.md.
**Structuring content integration**

I'm planning to integrate condensed content from USAGE.md into agents.md while keeping the existing material intact. After the reference to USAGE.md, I want to add a "Runtime helpers summary" with bullet points and code examples. The new sections will include quick references for runtime helpers, chunks, options available in templates, and directives with brief explanations. I’ll use proper Markdown formatting and include labeled code fences. First, I’ll provide a status update and then run functions.read_file in parallel for both agents.md and USAGE.md to get the latest content.
**Preparing for document updates**

I need to use the read_file tool, and since I want to parallelize, I’ll use the multi_tool_use.parallel wrapper, as it supports functions like read_file. I’ll run both reads and then create an apply_patch for agents.md to add new sections near the bottom. I want to provide context in the patch. After the edits, I should consider running lints, although it's not necessary for documentation. I’ll also include a summary of the changes. I’ll acknowledge the FETCH RULES, stating that I applied them in the status update before making the calls.</details></think>

---

Применяю правила пользователя: отвечаю по-русски, изменения в файлах и код‑примеры — на английском, не трогаю существующие комментарии. Выполню быстрый обзор содержимого `agents.md` и `USAGE.md`, затем внесу правки в `agents.md`, добавив конспект по runtime‑функциям, чанкам, `options` и директивам из `USAGE.md`.

---

Read file: undefined

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Planning documentation updates**

The document length can't be too large, but USAGE.md is quite lengthy. I think we can add an essential summary along with a link to USAGE. They want updates with info, so I’ll include concise bullet points and one example per function. I'll ensure to maintain the style of two-space indentation, even though markdown isn't code. I plan to structure the new sections for clarity, covering runtime helpers, options, directives, structural tags, and common patterns.
**Implementing documentation updates**

I need to avoid duplicating the "Core concepts" or "Formatting model," and I see that "agents.md" uses the .md extension, which is fine. For the patch, I don't think we need to follow linter errors since they're not essential for docs. We should include a status update and use the apply_patch tool. I'll insert new sections after line 67, but I need to ensure we keep “USAGE.md in sync.” Adding sections before or after "Common pitfalls" seems like the best option. I'll keep it organized!
**Preparing patch for documentation**

I want to add new sections after "Common pitfalls" to keep things organized and avoid any interference. My plan is to prepare a patch that appends these new sections to the end of agents.md while ensuring everything is in English. This way, I can keep the content clear and accessible for the user. With that in mind, let’s get started on crafting the content for the patch!</details></think>

---

Сначала внесу правки в `agents.md`, добавив сжатую выжимку из `USAGE.md`: справочник по runtime‑функциям, чанкам, `options`, директивам, структурным тегам и часто используемым паттернам. Затем вернусь с кратким резюме изменений.

---



---



---

Сделал правки в `agents.md`, добавив выжимку из `USAGE.md`: справочник по runtime‑функциям, чанкам, объекту `options`, директивам, структурным тегам и типовым паттернам. Линт прошёл без ошибок.

- Обновлён `agents.md`:
  - Добавлены разделы: Runtime helpers, Chunks model, `options`, Directives, Structural tags, Common patterns.
  - Вставлены короткие примеры на `.njs` для `partial`, `content`, `slot`, работы чанков и использования `options`.
  - Уточнено взаимодействие `partial` с чанками и перечислены флаги (`includeMainChunk`, `useHash`, `noContent` и др.).

---

